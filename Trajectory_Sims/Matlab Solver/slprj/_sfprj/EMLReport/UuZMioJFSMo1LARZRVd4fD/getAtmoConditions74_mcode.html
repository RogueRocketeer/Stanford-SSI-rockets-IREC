<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="49,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">% getTemperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Grabs atmospheric temperature at an altitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% www.engineeringtoolbox.com/international-standard-atmosphere-d_985.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Ian Gomez,  08/18/16</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% Input = altitude [m]; Output = temperature [K]</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,8" id="srcline8"> 8</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T2U3">T</span>,<span class="var type1" id="S3T2U4">P</span>,<span class="var type1" id="S4T2U5">rho</span>,<span class="var type1" id="S5T2U6">a</span>] = getAtmoConditions(<span class="var type1" id="S6T2U9">h</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,10" id="srcline10">10</a></span><span class="line"><span class="comment">% T [K]</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,11" id="srcline11">11</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T16:U6"><span class="var type1" id="S6T2U13">h</span> &lt; <span class="mxinfo " id="T2:U8">500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T2:U9"><span class="var type1" id="S2T2U17">T</span> = <span class="mxinfo " id="T2:U11">288.15</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,13" id="srcline13">13</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U12"><span class="var type1" id="S6T2U21">h</span> &lt; <span class="mxinfo " id="T2:U14">1000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T2:U15"><span class="var type1" id="S2T2U25">T</span> = <span class="mxinfo " id="T2:U17">284.9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,15" id="srcline15">15</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U18"><span class="var type1" id="S6T2U29">h</span> &lt; <span class="mxinfo " id="T2:U20">1500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T2:U21"><span class="var type1" id="S2T2U33">T</span> = <span class="mxinfo " id="T2:U23">281.7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,17" id="srcline17">17</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U24"><span class="var type1" id="S6T2U37">h</span> &lt; <span class="mxinfo " id="T2:U26">2000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T2:U27"><span class="var type1" id="S2T2U41">T</span> = <span class="mxinfo " id="T2:U29">275.2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,19" id="srcline19">19</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U30"><span class="var type1" id="S6T2U45">h</span> &lt; <span class="mxinfo " id="T2:U32">2500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T2:U33"><span class="var type1" id="S2T2U49">T</span> = <span class="mxinfo " id="T2:U35">271.9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,21" id="srcline21">21</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U36"><span class="var type1" id="S6T2U53">h</span> &lt; <span class="mxinfo " id="T2:U38">3000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T2:U39"><span class="var type1" id="S2T2U57">T</span> = <span class="mxinfo " id="T2:U41">268.7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,23" id="srcline23">23</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U42"><span class="var type1" id="S6T2U61">h</span> &lt; <span class="mxinfo " id="T2:U44">3500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T2:U45"><span class="var type1" id="S2T2U65">T</span> = <span class="mxinfo " id="T2:U47">265.4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,25" id="srcline25">25</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U48"><span class="var type1" id="S6T2U69">h</span> &lt; <span class="mxinfo " id="T2:U50">4000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T2:U51"><span class="var type1" id="S2T2U73">T</span> = <span class="mxinfo " id="T2:U53">262.2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,27" id="srcline27">27</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U54"><span class="var type1" id="S6T2U77">h</span> &lt; <span class="mxinfo " id="T2:U56">4500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T2:U57"><span class="var type1" id="S2T2U81">T</span> = <span class="mxinfo " id="T2:U59">258.9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,29" id="srcline29">29</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U60"><span class="var type1" id="S6T2U85">h</span> &lt; <span class="mxinfo " id="T2:U62">5000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T2:U63"><span class="var type1" id="S2T2U89">T</span> = <span class="mxinfo " id="T2:U65">255.7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,31" id="srcline31">31</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U66"><span class="var type1" id="S6T2U93">h</span> &lt; <span class="mxinfo " id="T2:U68">5500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T2:U69"><span class="var type1" id="S2T2U97">T</span> = <span class="mxinfo " id="T2:U71">252.4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,33" id="srcline33">33</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U72"><span class="var type1" id="S6T2U101">h</span> &lt; <span class="mxinfo " id="T2:U74">6000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T2:U75"><span class="var type1" id="S2T2U105">T</span> = <span class="mxinfo " id="T2:U77">249.2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,35" id="srcline35">35</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U78"><span class="var type1" id="S6T2U109">h</span> &lt; <span class="mxinfo " id="T2:U80">6500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,36" id="srcline36">36</a></span><span class="line">    <span class="mxinfo " id="T2:U81"><span class="var type1" id="S2T2U113">T</span> = <span class="mxinfo " id="T2:U83">245.9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,37" id="srcline37">37</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U84"><span class="var type1" id="S6T2U117">h</span> &lt; <span class="mxinfo " id="T2:U86">7000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo " id="T2:U87"><span class="var type1" id="S2T2U121">T</span> = <span class="mxinfo " id="T2:U89">242.7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,39" id="srcline39">39</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U90"><span class="var type1" id="S6T2U125">h</span> &lt; <span class="mxinfo " id="T2:U92">7500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,40" id="srcline40">40</a></span><span class="line">    <span class="mxinfo " id="T2:U93"><span class="var type1" id="S2T2U129">T</span> = <span class="mxinfo " id="T2:U95">239.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,41" id="srcline41">41</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U96"><span class="var type1" id="S6T2U133">h</span> &lt; <span class="mxinfo " id="T2:U98">8000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,42" id="srcline42">42</a></span><span class="line">    <span class="mxinfo " id="T2:U99"><span class="var type1" id="S2T2U137">T</span> = <span class="mxinfo " id="T2:U101">236.2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,43" id="srcline43">43</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U102"><span class="var type1" id="S6T2U141">h</span> &lt; <span class="mxinfo " id="T2:U104">8500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,44" id="srcline44">44</a></span><span class="line">    <span class="mxinfo " id="T2:U105"><span class="var type1" id="S2T2U145">T</span> = <span class="mxinfo " id="T2:U107">233.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,45" id="srcline45">45</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U108"><span class="var type1" id="S6T2U149">h</span> &lt; <span class="mxinfo " id="T2:U110">9000</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,46" id="srcline46">46</a></span><span class="line">    <span class="mxinfo " id="T2:U111"><span class="var type1" id="S2T2U153">T</span> = <span class="mxinfo " id="T2:U113">229.7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,47" id="srcline47">47</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U114"><span class="var type1" id="S6T2U157">h</span> &lt; <span class="mxinfo " id="T2:U116">9500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,48" id="srcline48">48</a></span><span class="line">    <span class="mxinfo " id="T2:U117"><span class="var type1" id="S2T2U161">T</span> = <span class="mxinfo " id="T2:U119">226.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,49" id="srcline49">49</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T16:U120"><span class="var type1" id="S6T2U165">h</span> &lt; <span class="mxinfo " id="T2:U122">10e3</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,50" id="srcline50">50</a></span><span class="line">    <span class="mxinfo " id="T2:U123"><span class="var type1" id="S2T2U169">T</span> = <span class="mxinfo " id="T2:U125">223.3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,51" id="srcline51">51</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,52" id="srcline52">52</a></span><span class="line">    <span class="mxinfo " id="T2:U126"><span class="var type1" id="S2T2U174">T</span> = <span class="mxinfo " id="T2:U128">10000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,53" id="srcline53">53</a></span><span class="line">    <span class="mxinfo " id="T28:U129"><span class="autoExtrinsicFcn" id="F75N3:B178">disp</span>(<span class="mxinfo " id="T48:U130"><span class="string">'Temperature data only available for altitudes below 10e3'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,54" id="srcline54">54</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,56" id="srcline56">56</a></span><span class="line"><span class="comment">% Pressure [Pa]</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo " id="T2:U131"><span class="var type1" id="S8T2U182">g</span> = <span class="mxinfo " id="T2:U133">9.81</span></span>;                   <span class="comment">% m/s^2</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,58" id="srcline58">58</a></span><span class="line"><span class="mxinfo " id="T2:U134"><span class="var type1" id="S9T2U186">avogadro</span> = <span class="mxinfo " id="T2:U136">6.0221409e23</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo " id="T2:U137"><span class="var type1" id="S10T2U190">k_boltz</span> = <span class="mxinfo " id="T2:U139">1.38064852e-23</span></span>;   <span class="comment">% J/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo " id="T2:U140"><span class="var type1" id="S11T2U194">m_air</span>   = <span class="mxinfo " id="T2:U142">29/<span class="var type1" id="S9T2U198">avogadro</span>*1e-3</span></span>; <span class="comment">% kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T2:U144"><span class="var type1" id="S12T2U202">R_air</span> =  <span class="mxinfo " id="T2:U146">287</span></span>;               <span class="comment">% J/kg K</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,62" id="srcline62">62</a></span><span class="line"><span class="mxinfo " id="T2:U147"><span class="var type1" id="S13T2U206">P_sl</span>  = <span class="mxinfo " id="T2:U149">101300</span></span>;             <span class="comment">% Pa, sea level pressure </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,63" id="srcline63">63</a></span><span class="line"><span class="mxinfo " id="T2:U150"><span class="var type1" id="S14T2U210">k</span> = <span class="mxinfo " id="T2:U152">1.4</span></span>;                    <span class="comment">% Air specific heats ratio</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,64" id="srcline64">64</a></span><span class="line"><span class="mxinfo " id="T2:U153"><span class="var type1" id="S3T2U214">P</span> = <span class="mxinfo " id="T2:U155"><span class="var type1" id="S13T2U216">P_sl</span>.*<span class="mxinfo " id="T2:U157">exp(<span class="mxinfo " id="T2:U158">(<span class="mxinfo " id="T2:U159"><span class="mxinfo " id="T2:U160"><span class="mxinfo " id="T2:U161">-<span class="var type1" id="S11T2U224">m_air</span></span>.*<span class="var type1" id="S8T2U225">g</span></span>.*<span class="var type1" id="S6T2U226">h</span></span>)./(<span class="mxinfo " id="T2:U165"><span class="var type1" id="S10T2U229">k_boltz</span>.*<span class="var type1" id="S2T2U230">T</span></span>)</span>)</span></span></span>; <span class="comment">% Pa</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,65" id="srcline65">65</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,66" id="srcline66">66</a></span><span class="line"><span class="comment">% Density [kg/m^3]</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,67" id="srcline67">67</a></span><span class="line"><span class="mxinfo " id="T2:U168"><span class="var type1" id="S4T2U233">rho</span> = <span class="mxinfo " id="T2:U170"><span class="mxinfo " id="T2:U171">1.2250</span>.*<span class="mxinfo " id="T2:U172">(<span class="mxinfo " id="T2:U173"><span class="mxinfo " id="T2:U174">288.15</span>./(<span class="mxinfo " id="T2:U175"><span class="mxinfo " id="T2:U176">288.15</span>-<span class="mxinfo " id="T2:U177"><span class="mxinfo " id="T2:U178">0.0065</span>.*<span class="var type1" id="S6T2U245">h</span></span></span>)</span>).^<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,68" id="srcline68">68</a></span><span class="line">    (1+9.80665.*0.0289644./(8.31432.*0.0065))</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,69" id="srcline69">69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,70" id="srcline70">70</a></span><span class="line"><span class="comment">% Mach number</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,71" id="srcline71">71</a></span><span class="line"><span class="mxinfo " id="T2:U180"><span class="var type1" id="S5T2U259">a</span>  = <span class="mxinfo " id="T2:U182">sqrt(<span class="mxinfo " id="T2:U183"><span class="mxinfo " id="T2:U184"><span class="var type1" id="S14T2U264">k</span>.*<span class="var type1" id="S12T2U265">R_air</span></span>.*<span class="var type1" id="S2T2U266">T</span></span>)</span></span>; <span class="comment">% m/s, local speed of sound</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,72" id="srcline72">72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,73" id="srcline73">73</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
